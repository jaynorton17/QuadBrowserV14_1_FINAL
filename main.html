
<!DOCTYPE html><html><head><style>
html,body{margin:0;padding:0;height:100%;background:#000;}
#screens{display:grid;width:100%;height:100%;grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr;}
.screen{overflow:hidden;}
webview{width:100%;height:100%;}
</style></head>
<body>
<div id="screens">
  <div class="screen"><webview id="s0" src="https://www.google.com" allowpopups></webview></div>
  <div class="screen"><webview id="s1" src="https://www.google.com" allowpopups></webview></div>
  <div class="screen"><webview id="s2" src="https://www.google.com" allowpopups></webview></div>
  <div class="screen"><webview id="s3" src="https://www.google.com" allowpopups></webview></div>
  <div class="screen"><webview id="s4" src="https://www.google.com" allowpopups></webview></div>
</div>

<script>
const {ipcRenderer}=require("electron");
let zoom=0.5;
const screens=document.querySelectorAll("webview");
const frames=[...document.querySelectorAll(".screen")];
const container=document.getElementById("screens");
const clickers=new Map();

function applyZoom(){
  screens.forEach(v=>{try{v.setZoomFactor(zoom);}catch(e){}});
  ipcRenderer.send("zoom-updated",zoom.toFixed(2));
}

function layout(c){
  frames.forEach((f,i)=>f.style.display=i<c?"block":"none");
  frames.forEach(f=>{f.style.gridColumn="";f.style.gridRow="";});
  if(c===1){container.style.gridTemplateColumns="1fr";container.style.gridTemplateRows="1fr";}
  if(c===2){container.style.gridTemplateColumns="1fr 1fr";container.style.gridTemplateRows="1fr";}
  if(c===3){
    container.style.gridTemplateColumns="1fr 1fr";
    container.style.gridTemplateRows="1fr 1fr";
    frames[2].style.gridColumn="1/3";
  }
  if(c===4){container.style.gridTemplateColumns="1fr 1fr";container.style.gridTemplateRows="1fr 1fr";}
  if(c===5){
    container.style.gridTemplateColumns="1fr 1fr 1fr";
    container.style.gridTemplateRows="1fr 1fr";
    frames[0].style.gridColumn="1/2"; frames[0].style.gridRow="1/2";
    frames[1].style.gridColumn="2/3"; frames[1].style.gridRow="1/2";
    frames[2].style.gridColumn="3/4"; frames[2].style.gridRow="1/2";
    frames[3].style.gridColumn="1/3"; frames[3].style.gridRow="2/3";
    frames[4].style.gridColumn="3/4"; frames[4].style.gridRow="2/3";
  }
  applyZoom();
}

function stopClicker(i){if(clickers.has(i)){clearInterval(clickers.get(i));clickers.delete(i);}}
function sendClick(v){if(!v)return;const r=v.getBoundingClientRect();if(!r.width||!r.height)return;const j=Math.max(1,Math.floor(Math.min(r.width,r.height)*0.02));const x=Math.max(1,Math.floor(r.width/2)+Math.floor(Math.random()*(j*2+1))-j);const y=Math.max(1,Math.floor(r.height/2)+Math.floor(Math.random()*(j*2+1))-j);try{v.sendInputEvent({type:"mouseDown",x,y,button:"left",clickCount:1});v.sendInputEvent({type:"mouseUp",x,y,button:"left",clickCount:1});}catch(e){} }
function startClicker(i,ms){const v=document.getElementById("s"+i);if(!v)return;stopClicker(i);const t=setInterval(()=>sendClick(v),Math.max(25,ms||1000));clickers.set(i,t);}

ipcRenderer.on("set-screens-count",(e,c)=>layout(c));
ipcRenderer.on("set-screen-url",(e,p)=>{
  let u=p.url.trim();
  if(!u)return;
  if(!/^https?:\/\//.test(u))u="https://"+u;
  document.getElementById("s"+p.index).src=u;
});
ipcRenderer.on("zoom-action",(e,a)=>{
  if(a==="in")zoom+=0.1;
  if(a==="out")zoom=Math.max(0.1,zoom-0.1);
  if(a==="reset")zoom=0.5;
  applyZoom();
});
ipcRenderer.on("start-clicker",(e,p)=>startClicker(p.index,p.interval));
ipcRenderer.on("stop-clicker",(e,i)=>stopClicker(i));
window.addEventListener("beforeunload",()=>clickers.forEach(c=>clearInterval(c)));

layout(4);
applyZoom();
</script>
</body></html>
